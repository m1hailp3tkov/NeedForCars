@model NeedForCars.Web.ViewModels.Cars.SearchViewModel
@using NeedForCars.Web.ViewModels.Cars

<h4>SearchViewModel</h4>
<hr />
<div class="row">
    <div class="col-md-4">
        <form asp-action="Search">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            <div class="form-group">
                <label asp-for="MakeId" class="control-label"></label>
                <select asp-for="MakeId" class="form-control">
                    <option value="">Any</option>
                </select>
                <span asp-validation-for="MakeId" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="ModelId" class="control-label"></label>
                <select asp-for="ModelId" class="form-control">
                    <option value="">Any</option>
                </select>
                <span asp-validation-for="ModelId" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="GenerationId" class="control-label"></label>
                <select asp-for="GenerationId" class="form-control">
                    <option value="">Any</option>
                </select>
                <span asp-validation-for="GenerationId" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="CarId" class="control-label"></label>
                <select asp-for="CarId" class="form-control">
                    <option value="">Any</option>
                </select>
                <span asp-validation-for="CarId" class="text-danger"></span>
            </div>

            <script src="~/lib/jquery//dist//jquery.js"></script>
            <script src="~/lib/jquery-validation/dist/jquery.validate.js"></script>
            <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>

            <script type="text/javascript">
                var makeUrl = '@Url.Action("FetchMakes", "Helper")';
                var modelUrl = '@Url.Action("FetchModels", "Helper")';
                var generationUrl = '@Url.Action("FetchGenerations", "Helper")';
                var carUrl = '@Url.Action("FetchCars", "Helper")';

                var makes = $('#MakeId');
                var models = $('#ModelId');
                var generations = $('#GenerationId');
                var cars = $('#CarId')

                $.getJSON(makeUrl, function (data) {
					if (!data) {
						return;
					}
                    $.each(data, function (index, item) {
                        makes.append($('<option></option>').val(item.id).text(item.name));
					});
				});

			    makes.change(function() {
                    models.empty();
                    models.append($('<option></option>').val('').text('Any'));
                    generations.empty();
                    generations.append($('<option></option>').val('').text('Any'));
                    cars.empty();
                    cars.append($('<option></option>').val('').text('Any'));

				    $.getJSON(modelUrl, { id: $(this).val() },function(data) {
					    if (!data) {
						    return;
					    }
					    $.each(data, function(index, item) {
						    models.append($('<option></option>').val(item.id).text(item.name));
					    });
				    });
			    })
			    models.change(function() {
                    generations.empty();
                    generations.append($('<option></option>').val('').text('Any'));
                    cars.empty();
                    cars.append($('<option></option>').val('').text('Any'));
				    $.getJSON(generationUrl, { id: $(this).val() },function(data) {
					    if (!data) {
						    return;
                        }
					    $.each(data, function(index, item) {
						    generations.append($('<option></option>').val(item.id).text(item.name));
					    });
				    });
                })
                generations.change(function () {
                    cars.empty();
                    cars.append($('<option></option>').val('').text('Any'));
                    $.getJSON(carUrl, { id: $(this).val() }, function (data) {
					    if (!data) {
						    return;
                        }
                        $.each(data, function (index, item) {
                            cars.append($('<option></option>').val(item.id).text(item.displayText));
					    });
				    });
                })

            </script>

            <div class="form-group">
                <label asp-for="MileageFrom" class="control-label"></label>
                <input asp-for="MileageFrom" class="form-control" />
                <span asp-validation-for="MileageFrom" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="MileageTo" class="control-label"></label>
                <input asp-for="MileageTo" class="form-control" />
                <span asp-validation-for="MileageTo" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="PriceFrom" class="control-label"></label>
                <input asp-for="PriceFrom" class="form-control" />
                <span asp-validation-for="PriceFrom" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="PriceTo" class="control-label"></label>
                <input asp-for="PriceTo" class="form-control" />
                <span asp-validation-for="PriceTo" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Currency" class="control-label"></label>
                <input asp-for="Currency" class="form-control" />
                <span asp-validation-for="Currency" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="YearOfProductionFrom" class="control-label"></label>
                <input asp-for="YearOfProductionFrom" class="form-control" />
                <span asp-validation-for="YearOfProductionFrom" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="YearOfProductionTo" class="control-label"></label>
                <input asp-for="YearOfProductionTo" class="form-control" />
                <span asp-validation-for="YearOfProductionTo" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="FuelType" class="control-label"></label>
                <input asp-for="FuelType" class="form-control" />
                <span asp-validation-for="FuelType" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="MinHP" class="control-label"></label>
                <input asp-for="MinHP" class="form-control" />
                <span asp-validation-for="MinHP" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="MaxHP" class="control-label"></label>
                <input asp-for="MaxHP" class="form-control" />
                <span asp-validation-for="MaxHP" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Transmission" class="control-label"></label>
                <input asp-for="Transmission" class="form-control" />
                <span asp-validation-for="Transmission" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="AlternativeFuel" class="control-label"></label>
                <input asp-for="AlternativeFuel" class="form-control" />
                <span asp-validation-for="AlternativeFuel" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="DriveWheel" class="control-label"></label>
                <input asp-for="DriveWheel" class="form-control" />
                <span asp-validation-for="DriveWheel" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="OrderingType" class="control-label"></label>
                <select asp-for="OrderingType" asp-items="@Html.GetEnumSelectList<OrderingType>()" class="form-control"></select>
                <span asp-validation-for="OrderingType" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Ordering" class="control-label"></label>
                <select asp-for="Ordering" asp-items="@Html.GetEnumSelectList<Ordering>()" class="form-control"></select>
                <span asp-validation-for="Ordering" class="text-danger"></span>
            </div>
            <div class="form-group">
                <input type="submit" value="Create" class="btn btn-primary" />
            </div>
        </form>
    </div>
</div>

<div>
    <a asp-action="Index">Back to List</a>
</div>

